---
title: OS bios
date: 2017-12-09 15:27:55
tags:
	- OS
	- Note
categories: OS
---

# BIOS

我也不知道我到底在记录了些什么，看完视屏整个人都是懵的。打算多看几遍好好啃下。

<!-- more -->

计算机启动后首先加载BIOS，BIOS读取加载程序，加载程序读取内核映像

## CPU初始化
CPU加点稳定后从0XFFFF0读第一条指令
+ CS:IP = 0xf000:fff0
+ 第一条指令是跳转指令
CPU初始状态为16位实模式
+ CS: IP是16位寄存器
+ 指令指针PC = 16 * CS + IP
+ 最大地址空间是1MB

## BIOS初始化过程
1. 硬件自检POST
2. 检测系统中内存和显卡等关键部位的存在和工作状态
3. 查找并执行显卡等接口卡BIOS，进行设备初始化
4. 执行系统BIOS，进行系统检测
 + 检测和配置系统中安装的即插即用设备
5. 更新CMOS中的拓展系统配置数据ESCD
6. 按指定启动顺序从软盘、硬盘或光驱启动

## 主引导记录的MBR格式
- 启动代码: 446byte
 + 检查分区表正确性
 + 加载并跳转到磁盘上的引导程序
- 硬盘分区表: 64byte
 + 描述分区状态和位置
 + 每个分区描述信息占据16byte
- 结束标志字: 2byte(55AA)
 + 主引导记录的有效标志

## 分区引导扇区格式
- 跳转指令：跳转到启动代码
 + 与平台相关代码
- 文件卷头：文件系统描述信息
- 启动代码：跳转到加载程序
- 结束标志： 55AA